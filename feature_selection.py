import re
import pandas
import pickle
import numpy as np
import glob
import heapq
import operator
from apk import APK
import matplotlib.pyplot as plt
import os
import commands
import json
import pickle
import pprint
import pandas as pd
import numpy
from numpy.random import randint

features_list=[]
n=13326
m=14605

for filepath in glob.iglob("/home/aman/kans/work_folder/final/finaltexts/*.txt"):
    print filepath
    with open(filepath,"rb") as f:
        new_dict= pickle.load(f)
    # print new_dict
    curr={}
    for i in new_dict:
        # print new_dict[i][0]
        features_list.append(i)


features_list= list(set(features_list))

print features_list
df3 = pd.DataFrame(columns=features_list)
for filepath in glob.iglob("/home/aman/kans/work_folder/final/finaltexts/*.txt"):
    print filepath
    with open(filepath,"rb") as f:
        new_dict= pickle.load(f)
    # print new_dict
    curr={}
    for i in new_dict:
        k=(1.0*new_dict[i][0]/n)
        kk=(1.0*new_dict[i][1])/m
        df3.loc[0,i]=k
        df3.loc[1,i]=kk

print df3
df3.to_csv("table2.csv", encoding='utf-8', index=False)

df = pd.DataFrame(columns=features_list)
df2 = pd.DataFrame(columns=features_list)

count=0
for filepath in glob.iglob("/home/aman/ANDROID_GOODWARE/*"):
    current=[]
    try:
        apkf = APK(filepath)
        current=current+apkf.get_activities()+apkf.get_services()+apkf.get_receivers()+apkf.get_providers()+apkf.get_permissions()
    except:
        continue
    dict={}
    # current= list(set(current))
    for i in features_list:
        dict[i]=0
    for i in current:
        if i in dict:
            dict[i]+=1
    for i in features_list:
        df.at[count,i]=dict[i]

    count+=1
    print count

df.to_csv("goodware_multiple.csv", encoding='utf-8', index=False)

count=0
for filepath in glob.iglob("/home/aman/ANDROID_MALWARE/*"):
    current=[]
    try:
        apkf = APK(filepath)
        current=current+apkf.get_activities()+apkf.get_services()+apkf.get_receivers()+apkf.get_providers()+apkf.get_permissions()
    except:
        continue
    dict={}
    # current= list(set(current))
    for i in features_list:
        dict[i]=0
    for i in current:
        if i in dict:
            dict[i]+=1
    for i in features_list:
        df2.at[count,i]=dict[i]

    count+=1
    print count
print df2
df2.to_csv("malware_multiple.csv", encoding='utf-8', index=False)
